<?php

namespace JordanPartridge\GithubClient\Data\Repos;

use Carbon\Carbon;
use JordanPartridge\GithubClient\Data\GitUserData;
use JordanPartridge\GithubClient\Enums\Visibility;

class RepoData
{
    public function __construct(
        public int $id,
        public string $node_id,
        public string $name,
        public string $full_name,
        public bool $private,
        public GitUserData $owner,
        public string $html_url,
        public ?string $description,
        public bool $fork,
        public string $url,
        public string $forks_url,
        public string $keys_url,
        public string $collaborators_url,
        public string $teams_url,
        public string $hooks_url,
        public string $issue_events_url,
        public string $events_url,
        public string $assignees_url,
        public string $branches_url,
        public string $tags_url,
        public string $blobs_url,
        public string $git_tags_url,
        public string $git_refs_url,
        public string $trees_url,
        public string $statuses_url,
        public string $languages_url,
        public string $stargazers_url,
        public string $contributors_url,
        public string $subscribers_url,
        public string $subscription_url,
        public string $commits_url,
        public string $git_commits_url,
        public string $comments_url,
        public string $issue_comment_url,
        public string $contents_url,
        public string $compare_url,
        public string $merges_url,
        public string $archive_url,
        public string $downloads_url,
        public string $issues_url,
        public string $pulls_url,
        public string $milestones_url,
        public string $notifications_url,
        public string $labels_url,
        public string $releases_url,
        public string $deployments_url,
        public Carbon $created_at,
        public Carbon $updated_at,
        public Carbon $pushed_at,
        public string $git_url,
        public string $ssh_url,
        public string $clone_url,
        public string $svn_url,
        public ?string $homepage,
        public int $size,
        public int $stargazers_count,
        public int $watchers_count,
        public ?string $language,
        public bool $has_issues,
        public bool $has_projects,
        public bool $has_downloads,
        public bool $has_wiki,
        public bool $has_pages,
        public bool $has_discussions,
        public int $forks_count,
        public ?string $mirror_url,
        public bool $archived,
        public bool $disabled,
        public int $open_issues_count,
        public ?LicenseData $license,
        public bool $allow_forking,
        public bool $is_template,
        public bool $web_commit_signoff_required,
        public array $topics,
        public ?Visibility $visibility,
        public int $forks,
        public int $open_issues,
        public int $watchers,
        public string $default_branch,
        public array $permissions,
    ) {}

    public static function fromArray(array $data): self
    {
        return new self(
            id: $data['id'],
            node_id: $data['node_id'],
            name: $data['name'],
            full_name: $data['full_name'],
            private: $data['private'],
            owner: GitUserData::fromArray($data['owner']),
            html_url: $data['html_url'],
            description: $data['description'] ?? null,
            fork: $data['fork'],
            url: $data['url'],
            forks_url: $data['forks_url'],
            keys_url: $data['keys_url'],
            collaborators_url: $data['collaborators_url'],
            teams_url: $data['teams_url'],
            hooks_url: $data['hooks_url'],
            issue_events_url: $data['issue_events_url'],
            events_url: $data['events_url'],
            assignees_url: $data['assignees_url'],
            branches_url: $data['branches_url'],
            tags_url: $data['tags_url'],
            blobs_url: $data['blobs_url'],
            git_tags_url: $data['git_tags_url'],
            git_refs_url: $data['git_refs_url'],
            trees_url: $data['trees_url'],
            statuses_url: $data['statuses_url'],
            languages_url: $data['languages_url'],
            stargazers_url: $data['stargazers_url'],
            contributors_url: $data['contributors_url'],
            subscribers_url: $data['subscribers_url'],
            subscription_url: $data['subscription_url'],
            commits_url: $data['commits_url'],
            git_commits_url: $data['git_commits_url'],
            comments_url: $data['comments_url'],
            issue_comment_url: $data['issue_comment_url'],
            contents_url: $data['contents_url'],
            compare_url: $data['compare_url'],
            merges_url: $data['merges_url'],
            archive_url: $data['archive_url'],
            downloads_url: $data['downloads_url'],
            issues_url: $data['issues_url'],
            pulls_url: $data['pulls_url'],
            milestones_url: $data['milestones_url'],
            notifications_url: $data['notifications_url'],
            labels_url: $data['labels_url'],
            releases_url: $data['releases_url'],
            deployments_url: $data['deployments_url'],
            created_at: Carbon::parse($data['created_at']),
            updated_at: Carbon::parse($data['updated_at']),
            pushed_at: Carbon::parse($data['pushed_at']),
            git_url: $data['git_url'],
            ssh_url: $data['ssh_url'],
            clone_url: $data['clone_url'],
            svn_url: $data['svn_url'],
            homepage: $data['homepage'] ?? null,
            size: $data['size'],
            stargazers_count: $data['stargazers_count'],
            watchers_count: $data['watchers_count'],
            language: $data['language'] ?? null,
            has_issues: $data['has_issues'],
            has_projects: $data['has_projects'],
            has_downloads: $data['has_downloads'],
            has_wiki: $data['has_wiki'],
            has_pages: $data['has_pages'],
            has_discussions: $data['has_discussions'],
            forks_count: $data['forks_count'],
            mirror_url: $data['mirror_url'] ?? null,
            archived: $data['archived'],
            disabled: $data['disabled'],
            open_issues_count: $data['open_issues_count'],
            license: isset($data['license']) ? LicenseData::fromArray($data['license']) : null,
            allow_forking: $data['allow_forking'],
            is_template: $data['is_template'],
            web_commit_signoff_required: $data['web_commit_signoff_required'],
            topics: $data['topics'] ?? [],
            visibility: isset($data['visibility']) ? Visibility::from($data['visibility']) : null,
            forks: $data['forks'],
            open_issues: $data['open_issues'],
            watchers: $data['watchers'],
            default_branch: $data['default_branch'],
            permissions: $data['permissions'] ?? [],
        );
    }

    public function toArray(): array
    {
        return [
            'id' => $this->id,
            'node_id' => $this->node_id,
            'name' => $this->name,
            'full_name' => $this->full_name,
            'private' => $this->private,
            'owner' => $this->owner->toArray(),
            'html_url' => $this->html_url,
            'description' => $this->description,
            'fork' => $this->fork,
            'url' => $this->url,
            'forks_url' => $this->forks_url,
            'keys_url' => $this->keys_url,
            'collaborators_url' => $this->collaborators_url,
            'teams_url' => $this->teams_url,
            'hooks_url' => $this->hooks_url,
            'issue_events_url' => $this->issue_events_url,
            'events_url' => $this->events_url,
            'assignees_url' => $this->assignees_url,
            'branches_url' => $this->branches_url,
            'tags_url' => $this->tags_url,
            'blobs_url' => $this->blobs_url,
            'git_tags_url' => $this->git_tags_url,
            'git_refs_url' => $this->git_refs_url,
            'trees_url' => $this->trees_url,
            'statuses_url' => $this->statuses_url,
            'languages_url' => $this->languages_url,
            'stargazers_url' => $this->stargazers_url,
            'contributors_url' => $this->contributors_url,
            'subscribers_url' => $this->subscribers_url,
            'subscription_url' => $this->subscription_url,
            'commits_url' => $this->commits_url,
            'git_commits_url' => $this->git_commits_url,
            'comments_url' => $this->comments_url,
            'issue_comment_url' => $this->issue_comment_url,
            'contents_url' => $this->contents_url,
            'compare_url' => $this->compare_url,
            'merges_url' => $this->merges_url,
            'archive_url' => $this->archive_url,
            'downloads_url' => $this->downloads_url,
            'issues_url' => $this->issues_url,
            'pulls_url' => $this->pulls_url,
            'milestones_url' => $this->milestones_url,
            'notifications_url' => $this->notifications_url,
            'labels_url' => $this->labels_url,
            'releases_url' => $this->releases_url,
            'deployments_url' => $this->deployments_url,
            'created_at' => $this->created_at->toISOString(),
            'updated_at' => $this->updated_at->toISOString(),
            'pushed_at' => $this->pushed_at->toISOString(),
            'git_url' => $this->git_url,
            'ssh_url' => $this->ssh_url,
            'clone_url' => $this->clone_url,
            'svn_url' => $this->svn_url,
            'homepage' => $this->homepage,
            'size' => $this->size,
            'stargazers_count' => $this->stargazers_count,
            'watchers_count' => $this->watchers_count,
            'language' => $this->language,
            'has_issues' => $this->has_issues,
            'has_projects' => $this->has_projects,
            'has_downloads' => $this->has_downloads,
            'has_wiki' => $this->has_wiki,
            'has_pages' => $this->has_pages,
            'has_discussions' => $this->has_discussions,
            'forks_count' => $this->forks_count,
            'mirror_url' => $this->mirror_url,
            'archived' => $this->archived,
            'disabled' => $this->disabled,
            'open_issues_count' => $this->open_issues_count,
            'license' => $this->license?->toArray(),
            'allow_forking' => $this->allow_forking,
            'is_template' => $this->is_template,
            'web_commit_signoff_required' => $this->web_commit_signoff_required,
            'topics' => $this->topics,
            'visibility' => $this->visibility?->value,
            'forks' => $this->forks,
            'open_issues' => $this->open_issues,
            'watchers' => $this->watchers,
            'default_branch' => $this->default_branch,
            'permissions' => $this->permissions,
        ];
    }
}
